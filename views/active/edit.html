<div id='content'>
    <div class='panel'>
        <div class='header'>
            <ol class='breadcrumb'>
                <li><a href='/'>活动</a><span class='divider'>/</span></li>
                <% if(typeof(action) !== 'undefined' && action == 'edit'){ %>
                <li class='active'>编辑活动</li>
                <% }else{ %>
                <li class='active'>发布活动</li>
                <% } %>
            </ol>
        </div>


        <div class="inner post">
          <% if(typeof(edit_error) !== 'undefined' && edit_error){ %>
          <div class="alert alert-error">
            <a class="close" data-dismiss="alert" href="#">&times;</a>
            <strong><%= edit_error %></strong>
          </div>
          <% } %>
            <form id="addActive" action="/active/create" method="post">
              <h4><%=language.getMessage('activity_information')%></h4>
              <div class="group">
                  <div class="m-label"><%=language.getMessage('activity_covers')%><strong>*</strong></div>
                  <div class="m-inp">
                      <div class="cover">
                          <img src="/public/images/cover_init.jpg" alt="">
                      </div>
                      <div class="m-up">
                          <p>
                            温馨提示：
                            <br>
                            此图片将作为此活动的封面，一张漂亮的封面图片可以提高浏览者视觉体验，同时可以宣传活动内容。
                            如果您并没有合适的图片，可以在系统图库中选择一张图片。
                            <br>
                            建议上传尺寸 400px*300px 的.png、.jpg、.gif图片，图片小于1M
                          </p>
                          <a>
                            <%=language.getMessage('upload_pics')%>
                            <input type="file" />
                          </a>
                          <a>
                            系统图库
                          </a>
                      </div>
                  </div>
              </div>

              <div class="group">
                  <div class="m-label"><%=language.getMessage('name_of_activity')%><strong>*</strong></div>
                  <div class="m-inp">
                    <input class="m-inp100" type="text" name="title" value="<%= typeof(title) !== 'undefined' && title || '' %>" />
                  </div>
              </div>

              <div class="group">
                  <div class="m-label"><%=language.getMessage('time_duration')%><strong>*</strong></div>
                  <div class="m-inp">
                    <input class="m-start" type="text" name="start_time" placeholder="开始时间" value="<%= typeof(start_time) !== 'undefined' && start_time || '' %>"/>
                    <input class="m-end" type="text" name="end_time" placeholder="结束时间" value="<%= typeof(end_time) !== 'undefined' && end_time || '' %>"/>
                  </div>
              </div>

              <div class="group">
                  <div class="m-label"><%=language.getMessage('activity_address')%><strong>*</strong></div>
                  <div class="m-inp">
                    <select class="m-prov" name="province" id="province">
                        <option value="北京">北京</option>
                        <option value="上海">上海</option>
                        <option value="浙江">浙江</option>
                        <option value="安徽">安徽</option>
                    </select>

                    <select class="m-city" name="city" id="city">
                        <option value="杭州">杭州</option>
                        <option value="温州">温州</option>
                        <option value="宁波">宁波</option>
                        <option value="台州">台州</option>
                    </select>

                    <input class="m-inp100" type="text" name="adress" placeholder="详细地址" value="<%= typeof(adress) !== 'undefined' && adress || '' %>">
                  </div>
              </div>

              <div class="group">
                  <div class="m-label"><%=language.getMessage('sponsor')%><strong>*</strong></div>
                  <div class="m-inp">
                    <input class="m-inp100" id="sponsor" type="text" name="sponsor" value="<%= typeof(sponsor) !== 'undefined' && sponsor || '' %>">
                    <!-- <select name="sponsor" id="sponsor">
                        <option value="才云">才云</option>
                        <option value="vm">vm</option>
                        <option value="kubecon">Kubecon</option>
                        <option value="北京">北京</option>
                    </select>
                    <button>添加主办方</button> -->
                  </div>
              </div>

              <div class="group">
                  <div class="m-label"><%=language.getMessage('content')%><strong>*</strong></div>
                  <div class="m-inp">
                    <textarea class='editor' name='active_detail' rows='20'
                              placeholder='文章支持 Markdown 语法, 请注意标记代码'
                    ><%= typeof(active_detail) !== 'undefined' && active_detail || '' %></textarea>
                  </div>
              </div>


              <h4>售票设置</h4>
              <div class="group01">
                <dl>
                    <dt><%=language.getMessage('participants')%><strong>*</strong></dt>
                    <dd>
                      <input type="text" name="people_num">
                    </dd>
                </dl>
                <dl>
                    <dt><%=language.getMessage('charge_of_Actiivity')%><strong>*</strong></dt>
                    <dd>
                      <select name="fees" id="fees">
                          <option value="false"><%=language.getMessage('free')%></option>
                          <option value="true"><%=language.getMessage('charge')%></option>
                      </select>
                    </dd>
                </dl>

                <dl id="cost">
                    <dt><%=language.getMessage('price')%><strong>*</strong></dt>
                    <dd>
                      <input type="text" name="cost">
                    </dd>
                </dl>

                <dl>
                    <dt><%=language.getMessage('audit_or_not')%><strong>*</strong></dt>
                    <dd>
                      <select name="verify" id="verify">
                          <option value="false"><%=language.getMessage('not_audit')%></option>
                          <option value="true"><%=language.getMessage('audit')%></option>
                      </select>
                    </dd>
                </dl>
              </div>

              <!--<h4>报名表单设置</h4>-->
              <button class="m-act-btn" type="submit">
                  <% if (typeof(language) !== 'undefined') { %>
                    <%=language.getMessage('submit')%>
                    <% } %>
              </button>
              <input type='hidden' name='_csrf' value='<%= csrf %>'>
            </form>
        </div>
    </div>
</div>

<%- partial('../includes/editor') %>

<!-- markdown editor -->
<script>
    (function () {
        var editor = new Editor();
        editor.render($('.editor')[0]);

        // 版块选择的检查，必须选择
        $('#create_topic_form').on('submit', function (e) {
            var tabValue = $('#tab-value').val();
            if (!tabValue) {
                alert('必须选择一个版块！');
                $('.submit_btn').button('reset');
                $('.tab-selector').css('color', 'red');
                return false;
            }
        });
        // END 版块选择的检查，必须选择

        // 选择招聘版块时，给出提示
        $('#tab-value').on('change', function () {
            var $this = $(this);
            var value = $this.val();
            var warnMsg = '';
            if (value === 'job') {
                warnMsg = '<strong>为避免被管理员删帖，发帖时请好好阅读<a href="http://cnodejs.org/topic/541ed2d05e28155f24676a12" target="_blank">《招聘帖规范》</a></strong>';
            } else if (value === 'ask') {
                warnMsg = '<strong>提问时，请遵循 <a href="http://doc.zengrong.net/smart-questions/cn.html" target="_blank">《提问的智慧》</a>中提及的要点，以便您更接收到高质量回复。</strong>'
            }
            $('#topic_create_warn').html(warnMsg);
        });
        // END 选择招聘版块时，给出提示

        //
        $('#fees').change(function() {
          if(this.value == 'true') {
            // $('#cost').show();
            $('#cost').css({"display":"inline-block"});
          } else if ( this.value == 'false') {
            // $('#cost').hide();
            $('#cost').css({"display":"none"});
          }
        });

    })();
</script>
